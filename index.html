<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>0mik0 — omari-portfolio</title>
  <style>
    /* [Same CSS as before — unchanged, omitted for brevity] */
  </style>
</head>

<body class="home-background">
<div id="sidebar">
  <a href="#" data-section="home">Home</a>
  <a href="#" data-section="projects">Projects</a>
  <a href="#" data-section="animations">Animations</a>
  <a href="#" data-section="storytelling">Storytelling</a>
  <a href="#" data-section="personal">Personal</a>
  <a href="#" data-section="characters">Characters</a>
</div>

<div id="content">
  <div id="home">
    <h1>Welcome to My Portfolio</h1>
    <p>I'm <strong>Omari Gobejishvili</strong>, I hope you enjoy the journey through my work.</p>
    <div class="bio-box">
      <h2>2D Generalist</h2>
      <p>Trained at the Tbilisi State Academy of Arts, I have over 7 years of experience working as a 2D artist in game development. My work spans storytelling, frame-by-frame animation, 3D modeling, illustration, character design, and game prop creation.</p>
    </div>
  </div>

  <!-- [Same section structure for projects, animations, etc. — unchanged] -->
</div>

<script>
function showSection(section) {
  const sections = ['home', 'projects', 'animations', 'storytelling', 'personal', 'characters'];
  sections.forEach(id => {
    const el = document.getElementById(id);
    if (el) el.style.display = (id === section) ? 'block' : 'none';
  });
  if (section === 'home') {
    document.body.classList.add('home-background');
  } else {
    document.body.classList.remove('home-background');
  }
}
document.getElementById('sidebar').addEventListener('click', (e) => {
  const section = e.target.getAttribute('data-section');
  if (section) {
    e.preventDefault();
    showSection(section);
  }
});
document.querySelectorAll('.back-btn').forEach(elem => {
  elem.addEventListener('click', e => {
    const section = e.target.getAttribute('data-section') || 'home';
    showSection(section);
  });
});

// Save & Load from localStorage
function saveGallery(sectionId) {
  const gallery = document.getElementById(`${sectionId}-gallery`);
  const items = Array.from(gallery.children).map(el => {
    const media = el.querySelector('img, video');
    const computed = window.getComputedStyle(el);
    return {
      type: media.tagName.toLowerCase(),
      src: media.src,
      left: el.style.left || computed.left,
      top: el.style.top || computed.top,
      width: el.style.width || computed.width,
      height: el.style.height || computed.height
    };
  });
  localStorage.setItem(`gallery-${sectionId}`, JSON.stringify(items));
}

async function fetchGitHubMedia(sectionId) {
  const repoOwner = "omik0";
  const repoName = "omari-portfolio";
  const branch = "main";
  const folderPath = `media/${sectionId}`;

  const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${folderPath}?ref=${branch}`;

  try {
    const response = await fetch(apiUrl);
    if (!response.ok) throw new Error("Failed to load GitHub media");
    const files = await response.json();

    files.forEach(file => {
      if (!file.download_url) return;

      const container = document.createElement('div');
      container.className = 'draggable';
      container.style.left = '0px';
      container.style.top = '0px';
      container.style.width = '150px';
      container.style.height = '150px';

      const mediaType = file.name.match(/\.(mp4|webm|ogg)$/i) ? 'video' : 'img';
      const media = document.createElement(mediaType);
      media.src = file.download_url;
      if (mediaType === 'video') media.controls = true;

      const resizeHandle = document.createElement('div');
      resizeHandle.className = 'resize-handle';

      container.appendChild(media);
      container.appendChild(resizeHandle);

      const gallery = document.getElementById(`${sectionId}-gallery`);
      gallery.appendChild(container);

      makeDraggable(container, sectionId);
      makeResizable(container, resizeHandle, sectionId);
    });
  } catch (err) {
    console.error(err);
  }
}

function loadGallery(sectionId) {
  const gallery = document.getElementById(`${sectionId}-gallery`);
  const data = localStorage.getItem(`gallery-${sectionId}`);
  if (!data) {
    fetchGitHubMedia(sectionId);
    return;
  }
  const items = JSON.parse(data);
  items.forEach(item => {
    const container = document.createElement('div');
    container.className = 'draggable';
    container.style.left = item.left;
    container.style.top = item.top;
    container.style.width = item.width;
    container.style.height = item.height;

    const deleteBtn = document.createElement('div');
    deleteBtn.className = 'delete-btn';
    deleteBtn.textContent = '×';
    deleteBtn.title = 'Delete';
    deleteBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      container.remove();
      saveGallery(sectionId);
    });
    container.appendChild(deleteBtn);

    const media = document.createElement(item.type);
    media.src = item.src;
    if (item.type === 'video') media.controls = true;
    container.appendChild(media);

    const resizeHandle = document.createElement('div');
    resizeHandle.className = 'resize-handle';
    container.appendChild(resizeHandle);

    gallery.appendChild(container);
    makeDraggable(container, sectionId);
    makeResizable(container, resizeHandle, sectionId);
  });
}

// [Same functions: handleUpload, makeDraggable, makeResizable, admin toggle — unchanged]

['projects', 'animations', 'storytelling', 'personal', 'characters'].forEach(loadGallery);
</script>

</body>
</html>

